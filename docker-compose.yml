version: "3"

services:
  reverse-proxy:
    image: traefik:v1.6.5 #The official Traefik docker image
    command: --web --docker --logLevel=DEBUG
    ports:
      - "80:80"     #The HTTP port
      - "443:443"
    labels:
      - "traefik.frontend.rule=Host: somers.co, www.somers.co"
      - "traefik.port=8080"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock #So that Traefik can listen to the Docker events
      - $PWD/traefik.toml:/traefik.toml
      - $PWD/acme.json:/acme.json
    environment:
      - GODADDY_API_KEY
      - GODADDY_API_SECRET
      - ACME_AGREE=true
    networks:
      - proxy
    restart:
      always

  # sononix:
  #   image: 'test-caddy'
  #   labels:
  #     - "traefik.backend=sononix"
  #     - "traefik.frontend.rule=Host:www.sononix.com,sononix.com"
  #     - "traefik.docker.network=proxy"
  #     - "traefik.frontend.entryPoints: http,https"
  #     - "traefik.port=2015"
  #     - "traefik.port=443"
  #   volumes:
  #     - $PWD/Caddyfile:/etc/Caddyfile
  #     - $PWD/tremage:/srv
  #     # - $PWD/.caddy:/etc/caddycerts
  #   environment:
  #     - GODADDY_API_KEY:${GODADDY_API_KEY}
  #     - GODADDY_API_SECRET:${GODADDY_API_SECRET}
  #     - ACME_AGREE=true
  #     - ENABLE_TELEMETRY=false
  #   networks:
  #     - proxy
#
#   c2ostudio:
#     image: 'test-caddy'
#     labels:
#       - "traefik.backend=c2ostudio"
#       - "traefik.frontend.rule=Host:www.c2o.studio,c2o.studio"
#       - "traefik.docker.network=proxy"
#       - "traefik.port=2015"
#       - "traefik.port=443"
#     volumes:
#       - ./Caddyfilec2o:/etc/Caddyfile
#       - ./c2ostudio:/srv
#       - ./.caddy:/etc/caddycerts
#     environment:
#       - CADDYPATH=/etc/caddycerts
#     networks:
#       - traefik_webgateway
#
volumes:
  data:
networks:
  proxy:
    external: true
